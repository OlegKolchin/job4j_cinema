<!doctype html>
<html lang="en" xmlns:width="http://www.w3.org/1999/xhtml">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <meta charset="UTF-8">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">

    <!-- Bootstrap CSS -->
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet">
    <script crossorigin="anonymous"
            integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
            src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
            src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <title>job4j_cinema</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" ></script>
</head>
<body>
<script>
    $(document).ready(function () {
        $.ajax({
            type: 'GET',
            url: 'http://localhost:8080/cinema/hall.do',
            dataType: 'json'
        }).done(function (data) {
            for (var ticket of data) {
                var rsl = ticket.row.toString() + ticket.cell.toString();
                $('#' + rsl).replaceWith($('<td class="table-danger"></td>>'));
            };

        }).fail(function (err) {
            console.log(err);
        });
    });
    function validate() {
        if (!$("input[name=place]").is(":checked")) {
            alert('Выберите место');
            return false;
        }
        return true;
    }
    function redirect() {
        window.location.href = 'http://localhost:8080/cinema/payment.html';
    }

    function getCheckedValue() {
        var tickets = document.getElementsByName('place');
        var rsl;
        for (var i = 0; i < tickets.length; i++) {
            if (tickets[i].checked) {
                rsl = tickets[i].value;
                break;
            }
        }
        localStorage.setItem("rowCell", rsl);
    }

    setInterval(function(){
        document.location.reload();
    },10000);
</script>
<div class="container">
    <form>
        <div class="row pt-3">
            <h4>
                Бронирование места на сеанс
            </h4>
            <table class="table table-bordered border-primary">
                <thead>
                <tr>
                    <th scope="col" style="width:  8.33%">Ряд</th>
                    <th scope="col">1</th>
                    <th scope="col">2</th>
                    <th scope="col">3</th>
                    <th scope="col">4</th>
                    <th scope="col">5</th>
                    <th scope="col">6</th>
                    <th scope="col">7</th>
                    <th scope="col">8</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="row">1</th>
                    <td class="table-success" id="11"><input type="radio" name="place" value="11"></td>
                    <td class="table-success" id="12"><input type="radio" name="place" value="12"></td>
                    <td class="table-success" id="13"><input type="radio" name="place" value="13"></td>
                    <td class="table-success" id="14"><input type="radio" name="place" value="14"></td>
                    <td class="table-success" id="15"><input type="radio" name="place" value="15"></td>
                    <td class="table-success" id="16"><input type="radio" name="place" value="16"></td>
                    <td class="table-success" id="17"><input type="radio" name="place" value="17"></td>
                    <td class="table-success" id="18"><input type="radio" name="place" value="18"></td>
                </tr>
                <tr>
                    <th scope="row">2</th>
                    <td class="table-success" id="21"><input type="radio" name="place" value="21"></td>
                    <td class="table-success" id="22"><input type="radio" name="place" value="22"></td>
                    <td class="table-success" id="23"><input type="radio" name="place" value="23"></td>
                    <td class="table-success" id="24"><input type="radio" name="place" value="24"></td>
                    <td class="table-success" id="25"><input type="radio" name="place" value="25"></td>
                    <td class="table-success" id="26"><input type="radio" name="place" value="26"></td>
                    <td class="table-success" id="27"><input type="radio" name="place" value="27"></td>
                    <td class="table-success" id="28"><input type="radio" name="place" value="28"></td>
                </tr>
                <tr>
                    <th scope="row">3</th>
                    <td class="table-success" id="31"><input type="radio" name="place" value="31"></td>
                    <td class="table-success" id="32"><input type="radio" name="place" value="32"></td>
                    <td class="table-success" id="33"><input type="radio" name="place" value="33"></td>
                    <td class="table-success" id="34"><input type="radio" name="place" value="34"></td>
                    <td class="table-success" id="35"><input type="radio" name="place" value="35"></td>
                    <td class="table-success" id="36"><input type="radio" name="place" value="36"></td>
                    <td class="table-success" id="37"><input type="radio" name="place" value="37"></td>
                    <td class="table-success" id="38"><input type="radio" name="place" value="38"></td>
                </tr>
                <tr>
                    <th scope="row">4</th>
                    <td class="table-success" id="41"><input type="radio" name="place" value="41"></td>
                    <td class="table-success" id="42"><input type="radio" name="place" value="42"></td>
                    <td class="table-success" id="43"><input type="radio" name="place" value="43"></td>
                    <td class="table-success" id="44"><input type="radio" name="place" value="44"></td>
                    <td class="table-success" id="45"><input type="radio" name="place" value="45"></td>
                    <td class="table-success" id="46"><input type="radio" name="place" value="46"></td>
                    <td class="table-success" id="47"><input type="radio" name="place" value="47"></td>
                    <td class="table-success" id="48"><input type="radio" name="place" value="48"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="row float-right">
            <button type="button" class="btn btn-success"
                    onclick="if (validate()) getCheckedValue(), redirect()">Оплатить</button>
        </div>
    </form>
</div>
</body>
</html>